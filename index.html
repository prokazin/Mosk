<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ú–æ—Å–∫–≤–∏—á 412 –ö–ª–∏–∫–µ—Ä - –°–ª–æ–∂–Ω—ã–π —Ä–µ–∂–∏–º</title>
<script src="https://unpkg.com/@vkontakte/vk-bridge/dist/browser.min.js"></script>
<style>
  /* ... (–≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... */
</style>
</head>
<body>
  <!-- ... (–≤—Å—è –ø—Ä–µ–¥—ã–¥—É—â–∞—è HTML-—Ä–∞–∑–º–µ—Ç–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... -->

  <script>
    vkBridge.send('VKWebAppInit');

    // –ë–∞–∑–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —É–º–µ–Ω—å—à–µ–Ω—ã
    let score = parseInt(localStorage.getItem('score')) || 0;
    let perClick = parseInt(localStorage.getItem('perClick')) || 1; // –±—ã–ª–æ 2
    let perSecond = parseInt(localStorage.getItem('perSecond')) || 0;
    
    // –°–∏—Å—Ç–µ–º–∞ –∏–∑–Ω–æ—Å–∞
    let wear = parseFloat(localStorage.getItem('wear')) || 0; // 0-100%
    let lastWearUpdate = parseInt(localStorage.getItem('lastWearUpdate')) || Date.now();
    
    let coins = parseInt(localStorage.getItem('coins')) || 0;
    let clicksCount = parseInt(localStorage.getItem('clicksCount')) || 0;

    const COINS_INTERVAL = 150; // –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 100
    const WEAR_RATE = 0.02; // –°–∫–æ—Ä–æ—Å—Ç—å –∏–∑–Ω–æ—Å–∞ –∑–∞ –∫–ª–∏–∫ (%)
    const WEAR_PENALTY = 0.5; // –ú–Ω–æ–∂–∏—Ç–µ–ª—å –ø—Ä–∏ –∏–∑–Ω–æ—Å–µ >80%

    // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    const scoreElement = document.getElementById('score');
    const perSecondElement = document.getElementById('perSecond');
    const clickBtn = document.getElementById('clickBtn');
    const coinProgress = document.getElementById('coinProgress');
    const progressText = document.getElementById('progressText');
    const wearElement = document.createElement('div');
    wearElement.id = 'wearDisplay';
    wearElement.style.marginTop = '10px';
    wearElement.style.fontWeight = '700';
    wearElement.style.color = '#d9534f';
    document.querySelector('.stats').appendChild(wearElement);

    // –ö–Ω–æ–ø–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π
    const upgrade1Btn = document.getElementById('upgrade1');
    const upgrade2Btn = document.getElementById('upgrade2');
    const upgrade3Btn = document.getElementById('upgrade3');
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ü–µ–Ω—ã —É–ª—É—á—à–µ–Ω–∏–π
    const UPGRADE_COSTS = {
      carburetor: 25,    // –±—ã–ª–æ 10
      turbo: 120,        // –±—ã–ª–æ 50
      spoiler: 500       // –±—ã–ª–æ 200
    };
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ü–µ–Ω—ã —Ä–µ–º–æ–Ω—Ç–∞
    const REPAIR_COSTS = {
      clutch: 250,        // –±—ã–ª–æ 100
      coolant: 400,       // –±—ã–ª–æ 150
      jets: 600           // –±—ã–ª–æ 200
    };

    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫
    upgrade1Btn.textContent = `–ö–∞—Ä–±—é—Ä–∞—Ç–æ—Ä (+5 –∫–º/—á) - ${UPGRADE_COSTS.carburetor} –∫–º`;
    upgrade2Btn.textContent = `–¢—É—Ä–±–æ–Ω–∞–¥–¥—É–≤ (+2 –∫–º –∑–∞ –∫–ª–∏–∫) - ${UPGRADE_COSTS.turbo} –∫–º`;
    upgrade3Btn.textContent = `–°–ø–æ–π–ª–µ—Ä (+20 –∫–º/—á) - ${UPGRADE_COSTS.spoiler} –∫–º`;
    
    document.getElementById('fixClutch').textContent = `–ü–æ—á–∏–Ω–∏—Ç—å —Å—Ü–µ–ø–ª–µ–Ω–∏–µ (${REPAIR_COSTS.clutch} –∫–º)`;
    document.getElementById('addCoolant').textContent = `–ó–∞–ª–∏—Ç—å —Ç–æ—Å–æ–ª (${REPAIR_COSTS.coolant} –∫–º)`;
    document.getElementById('tuneJets').textContent = `–ü–æ–¥–∫—Ä—É—Ç–∏—Ç—å –∂–∏–∫–ª—ë—Ä—ã (${REPAIR_COSTS.jets} –∫–º)`;

    function showNotification(text) {
      /* ... (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... */
    }

    function updateProgressBar() {
      /* ... (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... */
    }

    function updateWear() {
      // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∑–Ω–æ—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏
      const now = Date.now();
      const hoursPassed = (now - lastWearUpdate) / (1000 * 60 * 60);
      if (hoursPassed > 0) {
        wear = Math.min(100, wear + hoursPassed * 0.5); // 0.5% –≤ —á–∞—Å
        lastWearUpdate = now;
        saveGame();
      }
      
      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–∑–Ω–æ—Å
      let wearColor = '#5cb85c'; // –∑–µ–ª–µ–Ω—ã–π
      if (wear > 60) wearColor = '#f0ad4e'; // –∂–µ–ª—Ç—ã–π
      if (wear > 80) wearColor = '#d9534f'; // –∫—Ä–∞—Å–Ω—ã–π
      
      wearElement.innerHTML = `üîß –ò–∑–Ω–æ—Å: <span style="color:${wearColor}">${wear.toFixed(1)}%</span>`;
      
      // –ü—Ä–∏–º–µ–Ω—è–µ–º —à—Ç—Ä–∞—Ñ –∑–∞ –∏–∑–Ω–æ—Å
      return wear > 80 ? WEAR_PENALTY : 1;
    }

    function updateUI() {
      const wearPenalty = updateWear();
      
      scoreElement.textContent = Math.floor(score);
      perSecondElement.textContent = (perSecond * wearPenalty).toFixed(1);
      coinsDisplay.textContent = coins;
      updateProgressBar();

      // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫ —Å –Ω–æ–≤—ã–º–∏ —Ü–µ–Ω–∞–º–∏
      upgrade1Btn.disabled = score < UPGRADE_COSTS.carburetor;
      upgrade2Btn.disabled = score < UPGRADE_COSTS.turbo;
      upgrade3Btn.disabled = score < UPGRADE_COSTS.spoiler;

      fixClutchBtn.disabled = score < REPAIR_COSTS.clutch;
      addCoolantBtn.disabled = score < REPAIR_COSTS.coolant;
      tuneJetsBtn.disabled = score < REPAIR_COSTS.jets;
    }

    function saveGame() {
      localStorage.setItem('score', score);
      localStorage.setItem('perClick', perClick);
      localStorage.setItem('perSecond', perSecond);
      localStorage.setItem('coins', coins);
      localStorage.setItem('clicksCount', clicksCount);
      localStorage.setItem('wear', wear);
      localStorage.setItem('lastWearUpdate', lastWearUpdate);
    }

    function clickHandler() {
      const wearPenalty = updateWear();
      const effectivePerClick = wear > 80 ? perClick * WEAR_PENALTY : perClick;
      
      score += effectivePerClick;
      clicksCount++;
      wear += WEAR_RATE; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∏–∑–Ω–æ—Å –ø—Ä–∏ –∫–ª–∏–∫–µ
      
      updateProgressBar();
      
      if (clicksCount % COINS_INTERVAL === 0) {
        coins++;
        showNotification('üéâ –ü–æ–ª—É—á–µ–Ω–∞ –±–æ–Ω—É—Å–Ω–∞—è –º–æ–Ω–µ—Ç–∞!');
        setTimeout(() => {
          coinProgress.style.width = '0%';
          progressText.textContent = `0/${COINS_INTERVAL}`;
        }, 500);
      }
      
      updateUI();
      saveGame();
      
      clickBtn.classList.remove('jump');
      void clickBtn.offsetWidth;
      clickBtn.classList.add('jump');
    }

    function upgrade1() {
      if (score >= UPGRADE_COSTS.carburetor) {
        score -= UPGRADE_COSTS.carburetor;
        perSecond += 5; // –±—ã–ª–æ +8
        updateUI();
        saveGame();
        showNotification('‚öôÔ∏è –ö–∞—Ä–±—é—Ä–∞—Ç–æ—Ä —É–ª—É—á—à–µ–Ω! +5 –∫–º/—á');
      }
    }
    
    function upgrade2() {
      if (score >= UPGRADE_COSTS.turbo) {
        score -= UPGRADE_COSTS.turbo;
        perClick += 2; // –±—ã–ª–æ +3
        updateUI();
        saveGame();
        showNotification('üöÄ –¢—É—Ä–±–æ–Ω–∞–¥–¥—É–≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω! +2 –∫–º/–∫–ª–∏–∫');
      }
    }
    
    function upgrade3() {
      if (score >= UPGRADE_COSTS.spoiler) {
        score -= UPGRADE_COSTS.spoiler;
        perSecond += 20; // –±—ã–ª–æ +30
        updateUI();
        saveGame();
        showNotification('üî• –°–ø–æ–π–ª–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω! +20 –∫–º/—á');
      }
    }

    function fixClutch() {
      if (score >= REPAIR_COSTS.clutch) {
        score -= REPAIR_COSTS.clutch;
        wear = Math.max(0, wear - 15);
        showNotification('üîß –°—Ü–µ–ø–ª–µ–Ω–∏–µ –ø–æ—á–∏–Ω–µ–Ω–æ! –ò–∑–Ω–æ—Å -15%');
        updateUI();
        saveGame();
      }
    }
    
    function addCoolant() {
      if (score >= REPAIR_COSTS.coolant) {
        score -= REPAIR_COSTS.coolant;
        wear = Math.max(0, wear - 25);
        showNotification('üíß –¢–æ—Å–æ–ª –∑–∞–ª–∏—Ç! –ò–∑–Ω–æ—Å -25%');
        updateUI();
        saveGame();
      }
    }
    
    function tuneJets() {
      if (score >= REPAIR_COSTS.jets) {
        score -= REPAIR_COSTS.jets;
        wear = Math.max(0, wear - 40);
        perSecond *= 1.05; // +5% –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏
        showNotification('‚öôÔ∏è –ñ–∏–∫–ª—ë—Ä—ã –ø–æ–¥–∫—Ä—É—á–µ–Ω—ã! –ò–∑–Ω–æ—Å -40% –∏ +5% –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏');
        updateUI();
        saveGame();
      }
    }

    // ... (–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ...

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ score —Å —É—á–µ—Ç–æ–º –∏–∑–Ω–æ—Å–∞
    setInterval(() => {
      const wearPenalty = wear > 80 ? WEAR_PENALTY : 1;
      score += perSecond * wearPenalty;
      updateUI();
      saveGame();
    }, 1000);

    updateUI();
  </script>
</body>
</html>
