<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ú–æ—Å–∫–≤–∏—á 412 –ö–ª–∏–∫–µ—Ä - –£–ª—É—á—à–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω</title>
<script src="https://unpkg.com/@vkontakte/vk-bridge/dist/browser.min.js"></script>
<style>
  /* ... (–≤—Å–µ –≤–∞—à–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... */
</style>
</head>
<body>
  <!-- ... (–≤–µ—Å—å –≤–∞—à –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π HTML –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... -->

  <script>
    vkBridge.send('VKWebAppInit');

    // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –±–∞–ª–∞–Ω—Å–∞ –≤ –Ω–∞—á–∞–ª–æ
    const BALANCE_MODIFIER = {
      basePerClick: 0.5,    // –£–º–µ–Ω—å—à–∞–µ–º –±–∞–∑–æ–≤—ã–π –∫–ª–∏–∫ –≤ 2 —Ä–∞–∑–∞
      upgradeCosts: 2.5,    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏–π –≤ 2.5 —Ä–∞–∑–∞
      upgradeEffects: 0.6,   // –£–º–µ–Ω—å—à–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç —É–ª—É—á—à–µ–Ω–∏–π –Ω–∞ 40%
      repairCosts: 3,       // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ä–µ–º–æ–Ω—Ç–∞ –≤ 3 —Ä–∞–∑–∞
      coinsInterval: 1.5    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –º–æ–Ω–µ—Ç –≤ 1.5 —Ä–∞–∑–∞
    };

    // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å)
    let score = parseInt(localStorage.getItem('score')) || 0;
    let perClick = parseInt(localStorage.getItem('perClick')) || 2;
    let perSecond = parseInt(localStorage.getItem('perSecond')) || 0;
    let coins = parseInt(localStorage.getItem('coins')) || 0;
    let clicksCount = parseInt(localStorage.getItem('clicksCount')) || 0;
    const COINS_INTERVAL = 100;

    // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã DOM (–æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å)
    const scoreElement = document.getElementById('score');
    const perSecondElement = document.getElementById('perSecond');
    const clickBtn = document.getElementById('clickBtn');
    const coinProgress = document.getElementById('coinProgress');
    const progressText = document.getElementById('progressText');
    const upgrade1Btn = document.getElementById('upgrade1');
    const upgrade2Btn = document.getElementById('upgrade2');
    const upgrade3Btn = document.getElementById('upgrade3');
    const fixClutchBtn = document.getElementById('fixClutch');
    const addCoolantBtn = document.getElementById('addCoolant');
    const tuneJetsBtn = document.getElementById('tuneJets');
    const coinsDisplay = document.getElementById('coins');
    const notification = document.getElementById('notification');
    let notificationTimeout;

    // –§—É–Ω–∫—Ü–∏—è showNotification –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    function showNotification(text) {
      clearTimeout(notificationTimeout);
      notification.textContent = text;
      notification.classList.add('show');
      notification.setAttribute('aria-hidden', 'false');
      notificationTimeout = setTimeout(() => {
        notification.classList.remove('show');
        notification.setAttribute('aria-hidden', 'true');
      }, 3500);
    }

    // –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è clickHandler
    function clickHandler() {
      // –£–º–µ–Ω—å—à–∞–µ–º –ø—Ä–æ–±–µ–≥ –∑–∞ –∫–ª–∏–∫
      score += perClick * BALANCE_MODIFIER.basePerClick;
      clicksCount++;
      
      // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –º–æ–Ω–µ—Ç
      const modifiedInterval = COINS_INTERVAL * BALANCE_MODIFIER.coinsInterval;
      const progress = (clicksCount % modifiedInterval) / modifiedInterval * 100;
      const remaining = modifiedInterval - (clicksCount % modifiedInterval);
      coinProgress.style.width = `${progress}%`;
      progressText.textContent = `${modifiedInterval - remaining}/${modifiedInterval}`;
      
      if (clicksCount % modifiedInterval === 0) {
        coins++;
        showNotification('üéâ –ü–æ–ª—É—á–µ–Ω–∞ –±–æ–Ω—É—Å–Ω–∞—è –º–æ–Ω–µ—Ç–∞!');
        setTimeout(() => {
          coinProgress.style.width = '0%';
          progressText.textContent = `0/${modifiedInterval}`;
        }, 500);
      }
      
      updateUI();
      saveGame();
      
      // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –∫–ª–∏–∫–∞
      clickBtn.classList.remove('jump');
      void clickBtn.offsetWidth;
      clickBtn.classList.add('jump');
    }

    // –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ª—É—á—à–µ–Ω–∏–π
    function upgrade1() {
      const cost = 10 * BALANCE_MODIFIER.upgradeCosts;
      const effect = 8 * BALANCE_MODIFIER.upgradeEffects;
      if (score >= cost) {
        score -= cost;
        perSecond += effect;
        updateUI();
        saveGame();
        showNotification(`‚öôÔ∏è –ö–∞—Ä–±—é—Ä–∞—Ç–æ—Ä —É–ª—É—á—à–µ–Ω! +${effect.toFixed(1)} –∫–º/—á`);
      }
    }

    function upgrade2() {
      const cost = 50 * BALANCE_MODIFIER.upgradeCosts;
      const effect = 3 * BALANCE_MODIFIER.upgradeEffects;
      if (score >= cost) {
        score -= cost;
        perClick += effect;
        updateUI();
        saveGame();
        showNotification(`üöÄ –¢—É—Ä–±–æ–Ω–∞–¥–¥—É–≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω! +${effect.toFixed(1)} –∫–º –∑–∞ –∫–ª–∏–∫`);
      }
    }

    function upgrade3() {
      const cost = 200 * BALANCE_MODIFIER.upgradeCosts;
      const effect = 30 * BALANCE_MODIFIER.upgradeEffects;
      if (score >= cost) {
        score -= cost;
        perSecond += effect;
        updateUI();
        saveGame();
        showNotification(`üî• –°–ø–æ–π–ª–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω! +${effect.toFixed(1)} –∫–º/—á`);
      }
    }

    // –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–º–æ–Ω—Ç–∞
    function fixClutch() {
      const cost = 100 * BALANCE_MODIFIER.repairCosts;
      if (score >= cost) {
        score -= cost;
        showNotification(`üîß –°—Ü–µ–ø–ª–µ–Ω–∏–µ –ø–æ—á–∏–Ω–µ–Ω–æ! (${cost} –∫–º)`);
        updateUI();
        saveGame();
      }
    }

    function addCoolant() {
      const cost = 150 * BALANCE_MODIFIER.repairCosts;
      if (score >= cost) {
        score -= cost;
        showNotification(`üíß –¢–æ—Å–æ–ª –∑–∞–ª–∏—Ç! (${cost} –∫–º)`);
        updateUI();
        saveGame();
      }
    }

    function tuneJets() {
      const cost = 200 * BALANCE_MODIFIER.repairCosts;
      if (score >= cost) {
        score -= cost;
        showNotification(`‚öôÔ∏è –ñ–∏–∫–ª—ë—Ä—ã –ø–æ–¥–∫—Ä—É—á–µ–Ω—ã! (${cost} –∫–º)`);
        updateUI();
        saveGame();
      }
    }

    // –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è updateUI
    function updateUI() {
      scoreElement.textContent = Math.floor(score);
      perSecondElement.textContent = (perSecond * BALANCE_MODIFIER.basePerClick).toFixed(1);
      coinsDisplay.textContent = coins;

      // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫ —Å –Ω–æ–≤—ã–º–∏ —Ü–µ–Ω–∞–º–∏
      upgrade1Btn.disabled = score < (10 * BALANCE_MODIFIER.upgradeCosts);
      upgrade2Btn.disabled = score < (50 * BALANCE_MODIFIER.upgradeCosts);
      upgrade3Btn.disabled = score < (200 * BALANCE_MODIFIER.upgradeCosts);

      fixClutchBtn.disabled = score < (100 * BALANCE_MODIFIER.repairCosts);
      addCoolantBtn.disabled = score < (150 * BALANCE_MODIFIER.repairCosts);
      tuneJetsBtn.disabled = score < (200 * BALANCE_MODIFIER.repairCosts);
    }

    // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è saveGame
    function saveGame() {
      localStorage.setItem('score', score);
      localStorage.setItem('perClick', perClick);
      localStorage.setItem('perSecond', perSecond);
      localStorage.setItem('coins', coins);
      localStorage.setItem('clicksCount', clicksCount);
    }

    // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π (–æ—Å—Ç–∞–≤–ª—è–µ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
    clickBtn.addEventListener('click', clickHandler);
    upgrade1Btn.addEventListener('click', upgrade1);
    upgrade2Btn.addEventListener('click', upgrade2);
    upgrade3Btn.addEventListener('click', upgrade3);
    fixClutchBtn.addEventListener('click', fixClutch);
    addCoolantBtn.addEventListener('click', addCoolant);
    tuneJetsBtn.addEventListener('click', tuneJets);

    // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è —Ç–∞–±–æ–≤ (–æ—Å—Ç–∞–≤–ª—è–µ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
    const tabButtons = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
    tabButtons.forEach((btn, idx) => {
      btn.addEventListener('click', () => {
        tabButtons.forEach(b => {
          b.classList.remove('active');
          b.setAttribute('aria-selected', 'false');
          b.tabIndex = -1;
        });
        tabContents.forEach(tc => tc.classList.remove('active'));

        btn.classList.add('active');
        btn.setAttribute('aria-selected', 'true');
        btn.tabIndex = 0;
        tabContents[idx].classList.add('active');
        tabContents[idx].focus();
      });
    });

    tabButtons[0].click();

    // –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –∞–≤—Ç–æ-–∫–ª–∏–∫ —Å —É—á–µ—Ç–æ–º –±–∞–ª–∞–Ω—Å–∞
    setInterval(() => {
      score += perSecond * BALANCE_MODIFIER.basePerClick;
      updateUI();
      saveGame();
    }, 1000);

    updateUI();
  </script>
</body>
</html>
